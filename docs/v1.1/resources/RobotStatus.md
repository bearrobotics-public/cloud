# Robot Status

Streaming endpoints that provide real-time updates on robot health, including battery levels, charging state, and connectivity.

-----------
## GetRobotStatus

Get the latest robot state.

Robot state includes connectivity and operational states.

### Request

##### robot_id `string` `required`
The ID of the robot to get status for.

##### JSON Request Example
=== "JSON"
    ```js
      {
        "robotId": "pennybot-abc123"
      }
    ```

### Response

##### robot_state `RobotState`
The current robot state.

##### JSON Response Example
=== "JSON"
    ```js
      {
        "robotState": {
          "connection": {
            "state": "STATE_CONNECTED"
          },
          "operational": {
            "state": "STATE_OPERATIONAL"
          }
        }
      }
    ```

### Errors

| ErrorCode  | Description |
|------------|-------------|
| `PERMISSION_DENIED` | Attempting to get status for a `robot_id` you don't own. <br /> Tip: check the spelling of the `robot_id` value. |
| `NOT_FOUND` | The specified robot ID does not exist or is not accessible. |

-----------
## SubscribeBatteryStatus
A [server side streaming RPC](https://grpc.io/docs/what-is-grpc/core-concepts/#server-streaming-rpc) endpoint to get battery state updates for the robot. Upon subscription, the latest battery state is sent immediately. Updates are streamed whenever the state changes.

### Request
##### selector `RobotSelector` `required`
`RobotSelector` is used to select specific robots. <br/>
 It supports selection by a list of robot IDs **OR** all robots at a given location.

| Field | Message Type | Description |
|------|------|-------------|
|`robot_ids`| `RobotIDs`| Selects robots by their specific IDs. <br/> Example: `["pennybot-123abc", "pennybot-abc123"]` |
|`location_id`|`string` |  Selects all robots at the specified location. |

##### JSON Request Example
=== "JSON"
    ```js
      {
        "selector": {
          "robot_ids": {
            "ids": ["pennybot-abc123", "pennybot-123abc"]
          }
        }
      }
    ```

### Response

##### metadata `EventMetadata`

| Field | Message Type | Description |
|------|------|-------------|
| `timestamp` | [Timestamp](https://github.com/protocolbuffers/protobuf/blob/main/src/google/protobuf/timestamp.proto) | The time when the event was recorded. |
| `sequence_number` | int64 | An incremental sequence number generated by the robot.<br />The sequence number should never be negative and can be reset to 0.<br />i.e. sequence is valid if it is larger than the previous number or 0. |

##### robot_id `string`
The robotID the message is associated with.

##### BatteryState
Represents the state of the robot's battery system.

| Field | Message Type | Description |
|------|------|-------------|
| `charge_percent` | int32 | State of charge, from 0 (empty) to 100 (fully charged). |
| `state` | State *enum*|  High-level charging state of the battery. |
| `charge_method` | ChargeMethod *enum* | Method by which the robot is being charged.|

##### State `enum`
| Name                   | Number | Description                                      |
|------------------------|--------|--------------------------------------------------|
| STATE_UNKNOWN          | 0      | Default value. It means the `state` field is not returned. |
| STATE_CHARGING          | 1      | Battery is currently charging.  |
| STATE_DISCHARGING          | 2      | Robot is not connected to a charger and is consuming battery power.         |
| STATE_FULL           | 3      | Battery is fully charged while connected to a charger; <br />no additional energy is being stored.                    |

##### ChargeMethod `enum`
| Name                   | Number | Description                                      |
|------------------------|--------|--------------------------------------------------|
| CHARGE_METHOD_UNKNOWN          | 0      | Default value. It means the `charge_method` field is not returned. |
| CHARGE_METHOD_NONE          | 1      | No charging method is currently active or applicable. |
| CHARGE_METHOD_WIRED          | 2      | Charging via a wired connection.     |
| CHARGE_METHOD_CONTACT           | 3      | Charging via contact-based interface (e.g., docking station).|

##### JSON Response Examples
=== "JSON"
    ```json
    {
      "metadata": {
        "timestamp": "2025-04-01T16:45:00Z",
        "sequenceNumber": 112
      },
      "robotId": "pennybot-123abc",
      "batteryState": {
        "chargePercent": 78,
        "state": "STATE_CHARGING",
        "chargeMethod": "CHARGE_METHOD_CONTACT"
      }
    }
    {
      "metadata": {
        "timestamp": "2025-04-01T16:45:02Z",
        "sequenceNumber": 113
      },
      "robotId": "pennybot-abc123",
      "batteryState": {
        "chargePercent": 42,
        "state": "STATE_DISCHARGING",
        "chargeMethod": "CHARGE_METHOD_NONE"
      }
    }
    ```

### Errors
| ErrorCode  | Description |
|------------|-------------|
| `PERMISSION_DENIED` | Attempting to request status for a `robot_id` or `location_id` you don't own. <br /> Tip: check the spelling of all `robot_id` or `location_id` values.|

-----------
## SubscribeRobotStatus
A [server side streaming RPC](https://grpc.io/docs/what-is-grpc/core-concepts/#server-streaming-rpc) endpoint to get the robot's connectivity and operational state. Upon subscription, the latest battery state is sent immediately. Updates are streamed as the robot's state changes.

### Request
##### selector `RobotSelector` `required`
`RobotSelector` is used to select specific robots. <br/>
 It supports selection by a list of robot IDs **OR** all robots at a given location.

| Field | Message Type | Description |
|------|------|-------------|
|`robot_ids`| `RobotIDs`| Selects robots by their specific IDs. <br/> Example: `["pennybot-123abc", "pennybot-abc123"]` |
|`location_id`|`string` |  Selects all robots at the specified location. |

##### JSON Request Example
=== "JSON"
    ```js
      {
        "selector": {
          "robot_ids": {
            "ids": ["pennybot-abc123", "pennybot-123abc"]
          }
        }
      }
    ```
### Response
##### metadata `EventMetadata`

| Field | Message Type | Description |
|------|------|-------------|
| `timestamp` | [Timestamp](https://github.com/protocolbuffers/protobuf/blob/main/src/google/protobuf/timestamp.proto) | The time when the event was recorded. |
| `sequence_number` | int64 | An incremental sequence number generated by the robot.<br />The sequence number should never be negative and can be reset to 0.<br />i.e. sequence is valid if it is larger than the previous number or 0. |

##### robot_id `string`
The robotID the message is associated with.

##### robot_state.connetion.state `enum`
Represents the online connection state between the cloud and the robot.

| Name                   | Number | Description                                      |
|------------------------|--------|--------------------------------------------------|
| STATE_UNKNOWN          | 0      | Default value. It means the `state` field is not returned. |
| STATE_CONNECTED          | 1      | The robot is connected to Bear cloud services. |
| STATE_DISCONNECTED          | 2      | The robot is offline or unreachable from the cloud.   |

##### JSON Response Example

=== "JSON"
    ```json
    {
      "metadata": {
        "timestamp": "2025-04-01T17:05:00Z",
        "sequenceNumber": 211
      },
      "robotId": "pennybot-123abc",
      "robotStates": {
        "connection": {
          "state": "STATE_CONNECTED"
        }
      }
    },
    {
      "metadata": {
        "timestamp": "2025-04-01T17:05:05Z",
        "sequenceNumber": 212
      },
      "robotId": "pennybot-abc123",
      "robotStates": {
        "connection": {
          "state": "STATE_DISCONNECTED"
        }
      }
    }
    ```

### Errors
| ErrorCode  | Description |
|------------|-------------|
| `PERMISSION_DENIED` | Attempting to request status for a `robot_id` or `location_id` you don't own. <br /> Tip: check the spelling of all `robot_id` or `location_id` values.|

-----------
## SubscribeErrorCodes
A [server side streaming RPC](https://grpc.io/docs/what-is-grpc/core-concepts/#server-streaming-rpc) endpoint to subscribe to error codes returned by the robot. Upon subscription, the latest known error codes are sent immediately. Updates are streamed when error codes change.

### Request

##### selector `RobotSelector` `required`
`RobotSelector` is used to select specific robots. It supports selection by a list of robot IDs **OR** all robots at a given location.

| Field | Message Type | Description |
|------|------|-------------|
|`robot_ids`| `RobotIDs`| Selects robots by their specific IDs. <br/> Example: `["pennybot-123abc", "pennybot-abc123"]` |
|`location_id`|`string` |  Selects all robots at the specified location. |

##### JSON Request Example
=== "JSON"
    ```js
      {
        "selector": {
          "robotIds": {
            "ids": ["pennybot-abc123", "pennybot-123abc"]
          }
        }
      }
    ```

### Response

##### error_codes `map<string, ErrorCodesWithMetadata>`
A mapping of error codes returned by individual robots.
Each entry pairs a robot ID (key) with a corresponding error code and metadata.
Note that each robot maintains its own metadata, so messages should be correlated if and only if they correspond to the same robot ID.

##### ErrorCodesWithMetadata
| Field | Message Type | Description |
|------|------|-------------|
| `metadata` | `EventMetadata` | Metadata associated with the error codes. |
| `error_codes` | `ErrorCodes` | The error codes reported by the robot. |

##### ErrorCodes
| Field | Message Type | Description |
|------|------|-------------|
| `codes` | repeated string | List of error codes currently active on the robot. |

##### JSON Response Example
=== "JSON"
    ```js
    {
      "errorCodes": {
        "pennybot-abc123": {
          "metadata": {
            "timestamp": "2025-04-01T17:10:00Z",
            "sequenceNumber": 215
          },
          "errorCodes": {
            "codes": ["E001", "E042"]
          }
        },
        "pennybot-123abc": {
          "metadata": {
            "timestamp": "2025-04-01T17:10:00Z",
            "sequenceNumber": 216
          },
          "errorCodes": {
            "codes": []
          }
        }
      }
    }
    ```

### Errors
| ErrorCode  | Description |
|------------|-------------|
| `PERMISSION_DENIED` | Attempting to request error codes for a `robot_id` or `location_id` you don't own. <br /> Tip: check the spelling of all `robot_id` or `location_id` values.|

-----------
## SubscribeNetworkStatus
A [server side streaming RPC](https://grpc.io/docs/what-is-grpc/core-concepts/#server-streaming-rpc) endpoint to subscribe to network status updates for robots. Upon subscription, the latest known network states are sent immediately. Updates are streamed when any network state changes.

### Request

##### selector `RobotSelector` `required`
`RobotSelector` is used to select specific robots. It supports selection by a list of robot IDs **OR** all robots at a given location.

| Field | Message Type | Description |
|------|------|-------------|
|`robot_ids`| `RobotIDs`| Selects robots by their specific IDs. <br/> Example: `["pennybot-123abc", "pennybot-abc123"]` |
|`location_id`|`string` |  Selects all robots at the specified location. |

##### JSON Request Example
=== "JSON"
    ```js
      {
        "selector": {
          "robotIds": {
            "ids": ["pennybot-abc123", "pennybot-123abc"]
          }
        }
      }
    ```

### Response

##### network_states `map<string, NetworkStateWithMetadata>`
A mapping of network states reported by individual robots.
Each entry pairs a robot ID (key) with its corresponding network state and metadata.
Note that each robot maintains its own metadata, so messages should be correlated if and only if they correspond to the same robot ID.

##### NetworkStateWithMetadata
| Field | Message Type | Description |
|------|------|-------------|
| `metadata` | `EventMetadata` | Metadata associated with the network state. |
| `network_state` | `NetworkState` | The network state reported by the robot. |

##### NetworkState
Represents the network connectivity state of the robot.

| Field | Message Type | Description |
|------|------|-------------|
| `connection_state` | ConnectionState *enum* | Current network connection state. |
| `signal_strength` | int32 | Signal strength in dBm (if available). |
| `network_type` | NetworkType *enum* | Type of network connection. |

##### ConnectionState `enum`
| Name | Number | Description |
|------|--------|-------------|
| CONNECTION_STATE_UNKNOWN | 0 | Default value. It means the `connection_state` field is not returned. |
| CONNECTION_STATE_CONNECTED | 1 | The robot is connected to the network. |
| CONNECTION_STATE_DISCONNECTED | 2 | The robot is disconnected from the network. |
| CONNECTION_STATE_CONNECTING | 3 | The robot is attempting to connect to the network. |

##### NetworkType `enum`
| Name | Number | Description |
|------|--------|-------------|
| NETWORK_TYPE_UNKNOWN | 0 | Default value. It means the `network_type` field is not returned. |
| NETWORK_TYPE_WIFI | 1 | WiFi network connection. |
| NETWORK_TYPE_ETHERNET | 2 | Ethernet network connection. |
| NETWORK_TYPE_CELLULAR | 3 | Cellular network connection. |

### Errors
| ErrorCode  | Description |
|------------|-------------|
| `PERMISSION_DENIED` | Attempting to request network status for a `robot_id` or `location_id` you don't own. <br /> Tip: check the spelling of all `robot_id` or `location_id` values. |

##### JSON Response Example
=== "JSON"
    ```js
    {
      "networkStates": {
        "pennybot-abc123": {
          "metadata": {
            "timestamp": "2025-04-01T16:00:00Z",
            "sequenceNumber": 105
          },
          "networkState": {
            "connectionState": "CONNECTION_STATE_CONNECTED",
            "signalStrength": -45,
            "networkType": "NETWORK_TYPE_WIFI"
          }
        },
        "pennybot-123abc": {
          "metadata": {
            "timestamp": "2025-04-01T16:00:00Z",
            "sequenceNumber": 106
          },
          "networkState": {
            "connectionState": "CONNECTION_STATE_DISCONNECTED",
            "signalStrength": 0,
            "networkType": "NETWORK_TYPE_UNKNOWN"
          }
        }
      }
    }
    ```
